---
title: "salinity_climatechange_prep"
output: github_document
params: 
    datasource: csv
---
```{r setup}

## Libraries
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(RMySQL)
library(stringr)
library(tools)
library(rprojroot) # install.packages('rprojroot')

source('~/github/bhi/baltic2015/prep/common.r')

## rprojroot
root <- rprojroot::is_rstudio_project


## make_path() function to 
make_path <- function(...) rprojroot::find_root_file(..., criterion = is_rstudio_project)



dir_layers = make_path('baltic2015/layers') # replaces  file.path(dir_baltic, 'layers')


# root$find_file("README.md")
# 
# root$find_file("ao_need_gl2014.csv")
# 
# root <- find_root_file("install_ohicore.r", 
# 
# withr::with_dir(
#   root_file("DESCRIPTION"))



dir_salincc    = file.path(dir_prep, 'pressures/climate_change/salinity_climatechange')


## add a README.md to the prep directory with the rawgit.com url for viewing on GitHub
create_readme(dir_salincc, 'salinity_climatechange_prep.rmd') 
```


## 1. Background



## 2. Data
Annual surface water salinity (0-5 m) by basin.  
Annual deep water salinity (50 m) by basin.  

### 2.1 Data source
Data are from the [BALTSEM model](http://www.balticnest.org/balticnest/thenestsystem/baltsem.4.3186f824143d05551ad20ea.html), run by Bärbel Müller Karulis from the Baltic Sea Centre at Stockholm University.

### 2.2 Hindcast


### 2.3 Projections


## 3. Pressure model
Two data layer, surface water salinity and deep water salinity. Each use the same current condition and rescaling procedure below.  

### 3.1 Current conditions
Current conditions = mean salinity 2010-2014  
- Use hindcast data??  

### 3.2 rescaling data

min value = mininium annual salinity duing reference period (1960-1990)  

max value = maximum annual salinity during the future projection period (2020-2050)  

### 3.3 BHI region pressure
Apply basin values to BHI regions.  

## Layer prep

```{r TODO, echo=FALSE, message=FALSE}
## read in data...

## plot data...

```
